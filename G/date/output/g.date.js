(function(a,b){String.prototype.parseToArray=function(a,b){var c=this.split(b||"|");return a?function(b,d){for(;b--;)c[b]=parseInt(c[b],a);return c}(c.length):c},String.trim||(String.prototype.trim=function(){var a=this,a=a.replace(/^\s\s*/,""),b=/\s/,c=a.length;while(b.test(a.charAt(--c)));return a.slice(0,c+1)}),String.replaceTpl||(String.prototype.replaceTpl=function(a){return this.replace(/#\{([^}]*)\}/mg,function(b,c){return b=a[c.trim()]})}),a.conf||(a.conf={}),a.G||(a.G={});var c=conf.date={days:[31,28,31,30,31,30,31,31,30,31,30,31],feast:{"1-1":"\u5143\u65e6\u8282","2-14":"\u60c5\u4eba\u8282","3-5":"\u96f7\u950b\u65e5","3-8":"\u5987\u5973\u8282","3-12":"\u690d\u6811\u8282","3-15":"\u6d88\u8d39\u65e5","4-1":"\u611a\u4eba\u8282","5-1":"\u52b3\u52a8\u8282","5-4":"\u9752\u5e74\u8282","6-1":"\u513f\u7ae5\u8282","7-1":"\u5efa\u515a\u8282","8-1":"\u5efa\u519b\u8282","9-10":"\u6559\u5e08\u8282","10-1":"\u56fd\u5e86\u8282","12-24":"\u5e73\u5b89\u591c","12-25":"\u5723\u8bde\u8282"},lunar:{tpl:"#{y}-#{m}-#{d} \u661f\u671f#{W} \u519c\u5386 #{CM}#{CD} #{gy}(#{sx}) #{gm} #{gd} #{so} #{cf} #{gf}",leap:"ezc|esg|wog|gr9|15k0|16xc|1yl0|h40|ukw|gya|esg|wqe|wk0|15jk|2k45|zsw|16e8|yaq|tkg|1t2v|ei8|wj4|zp1|l00|lkw|2ces|8kg|tio|gdu|ei8|k12|1600|1aa8|lud|hxs|8kg|257n|t0g|2i8n|13rk|1600|2ld2|ztc|h40|2bas|7gw|t00|15ma|xg0|ztj|lgg|ztc|1v11|fc0|wr4|1sab|gcw|xig|1a34|l28|yhy|xu8|ew0|xr8|wog|g9s|1bvn|16xc|i1j|h40|tsg|fdh|es0|wk0|161g|15jk|1654|zsw|zvk|284m|tkg|ek0|xh0|wj4|z96|l00|lkw|yme|xuo|tio|et1|ei8|jw0|n1f|1aa8|l7c|gxs|xuo|tsl|t0g|13s0|16xg|1600|174g|n6a|h40|xx3|7gw|t00|141h|xg0|zog|10v8|y8g|gyh|exs|wq8|1unq|gc0|xf4|nys|l28|y8g|i1e|ew0|wyu|wkg|15k0|1aat|1640|hwg|nfn|tsg|ezb|es0|wk0|2jsm|15jk|163k|17ph|zvk|h5c|gxe|ek0|won|wj4|xn4|2dsl|lk0|yao".parseToArray(36),jqmap:"0|gd4|wrn|1d98|1tuh|2akm|2rfn|38g9|3plp|46vz|4o9k|55px|5n73|64o5|6m37|73fd|7kna|81qe|8io7|8zgq|9g4b|9wnk|ad3g|ath2|".parseToArray(36),jqnames:"\u5c0f\u5bd2|\u5927\u5bd2|\u7acb\u6625|\u96e8\u6c34|\u60ca\u86f0|\u6625\u5206|\u6e05\u660e|\u8c37\u96e8|\u7acb\u590f|\u5c0f\u6ee1|\u8292\u79cd|\u590f\u81f3|\u5c0f\u6691|\u5927\u6691|\u7acb\u79cb|\u5904\u6691|\u767d\u9732|\u79cb\u5206|\u5bd2\u9732|\u971c\u964d|\u7acb\u51ac|\u5c0f\u96ea|\u5927\u96ea|\u51ac\u81f3".parseToArray(),c1:"|\u4e00|\u4e8c|\u4e09|\u56db|\u4e94|\u516d|\u4e03|\u516b|\u4e5d|\u5341".parseToArray(),c2:"\u521d|\u5341|\u5eff|\u5345|".parseToArray(),wk:"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d",tg:"\u7532\u4e59\u4e19\u4e01\u620a\u5df1\u5e9a\u8f9b\u58ec\u7678",dz:"\u5b50\u4e11\u5bc5\u536f\u8fb0\u5df3\u5348\u672a\u7533\u9149\u620c\u4ea5",sx:"\u9f20\u725b\u864e\u5154\u9f99\u86c7\u9a6c\u7f8a\u7334\u9e21\u72d7\u732a",feast:{"1-1":"\u6625\u8282","1-15":"\u5143\u5bb5\u8282","5-5":"\u7aef\u5348\u8282","8-15":"\u4e2d\u79cb\u8282","9-9":"\u91cd\u9633\u8282","12-8":"\u814a\u516b\u8282"}},isl:{tpl:"#{IW} - #{d} \u0645\u0646 #{M} #{y} - #{id} #{IM} #{iy}",weekNames:["\u0627\u0644\u0623\u062d\u062f","\u0627\u0644\u0627\u062b\u0646\u064a\u0646","\u0627\u0644\u062b\u0644\u0627\u062b\u0627\u0621","\u0627\u0644\u0623\u0631\u0628\u0639\u0627\u0621","\u0627\u0644\u062e\u0645\u064a\u0633","\u0627\u0644\u062c\u0645\u0639\u0629","\u0627\u0644\u0633\u0628\u062a"],weekNames_Malay:["Ahad","Ithnin","Thulatha","Arbaa","Khams","Jumuah","Sabt"],gMonthNames:["\u064a\u0646\u0627\u0646\u0631","\u0641\u0628\u0631\u0627\u064a\u0631","\u0645\u0627\u0631\u0633","\u0627\u0628\u0631\u064a\u0644","\u0645\u0627\u064a\u0648","\u064a\u0648\u0646\u064a\u0648","\u064a\u0648\u0644\u064a\u0648","\u0623\u063a\u0633\u0637\u0633","\u0633\u0628\u062a\u0645\u0628\u0631","\u0623\u0643\u062a\u0648\u0628\u0631","\u0646\u0648\u0641\u0645\u062a\u0631","\u062f\u064a\u0633\u0645\u0628\u0631"],monthNames:["\u0645\u062d\u0631\u0645","\u0635\u0641\u0631","\u0631\u0628\u064a\u0639 \u0627\u0644\u0623\u0648\u0644","\u0631\u0628\u064a\u0639 \u0627\u0644\u0622\u062e\u0631","\u062c\u0645\u0627\u062f\u0649 \u0627\u0644\u0623\u0648\u0644","\u062c\u0645\u0627\u062f\u0649 \u0627\u0644\u0622\u062e\u0631","\u0631\u062c\u0628","\u0634\u0639\u0628\u0627\u0646","\u0631\u0645\u0636\u0627\u0646","\u0634\u0648\u0627\u0644","\u0630\u064a \u0627\u0644\u0642\u0639\u062f\u0629","\u0630\u064a \u0627\u0644\u062d\u062c\u0629"],monthNames_Malay:["Muharram","Safar","Rabi'ul Awwal","Rabi'ul Akhir","Jumadal Ula","Jumadal Akhira","Rajab","Sha'ban","Ramadan","Shawwal","Dhul Qa'ada","Dhul Hijja"]}},d={isDate:function(a){return a instanceof Date&&!isNaN(a)},getDate:function(a){!d.isDate(a)&&(a=new Date);return{y:a.getFullYear(),m:a.getMonth()+1,d:a.getDate()}},format:function(a,b){b=b||new Date,a=a||"yyyy-MM-dd";var c=d.getDate(b),e={M:c.m,d:c.d,h:b.getHours(),m:b.getMinutes(),s:b.getSeconds()},f;for(var g in e)f=e[g],a=a.replace(new RegExp("("+g+"+)","g"),function(a,b){return f<10&&b.length>1?"0"+f:f});return a.replace(/(y+)/ig,function(a,b){return(c.y+"").substr(4-Math.min(4,b.length))})},getDaysByLunarMonth:function(a,b){return c.lunar.leap[a-1900]&65536>>b?30:29},getLeapMonth:function(a){return c.lunar.leap[a-1900]&15},getLeapDays:function(a){return d.getLeapMonth(a)?c.lunar.leap[a-1900]&65536?30:29:0},getDaysByMonth:function(a,b){return b==2?a%4==0&&a%100!=0||a%400==0?29:28:c.days[b-1]},getDaysByYear:function(a){for(var b=32768,e=348;b>8;b>>=1)e+=c.lunar.leap[a-1900]&b?1:0;return e+d.getLeapDays(a)},getDateBySolar:function(a,b){var d=new Date(31556925974.7*(a-1900)+c.lunar.jqmap[b]*6e4+Date.UTC(1900,0,6,2,5));return{m:d.getUTCMonth()+1,d:d.getUTCDate()}},getFeast:function(a,b,e,f){var g=(e?c.lunar.feast:c.feast)[a+"-"+b]||"";e&&f&&a==12&&d.getDaysByLunarMonth(f,12)==b&&(g="\u9664\u5915");return g},getSolar:function(a,b,e){var f=c.lunar.jqnames,g=f.length,h;while(g--){h=d.getDateBySolar(a,g);if(h.m==b&&h.d==e)return f[g]}return""},cyclical:function(a){return c.lunar.tg.charAt(a%10)+c.lunar.dz.charAt(a%12)},toLunar:function(a,b,e){var f=1900,g=0,h=(new Date(a,b-1,e)-new Date(1900,0,31))/864e5,i=d.getLeapMonth(a),j=!1,k;for(;f<2050&&h>0;f++)g=d.getDaysByYear(f),h-=g;h<0&&(h+=g,f--),k=f;for(f=1;f<13&&h>0;f++)i>0&&f==i+1&&j===!1?(--f,j=!0,g=d.getLeapDays(k)):g=d.getDaysByLunarMonth(k,f),j==!0&&f==i+1&&(j=!1),h-=g;h==0&&i>0&&f==i+1&&!j&&--f,h<0&&(h+=g,--f),h==0&&(j=f==i),h=h+1;return{cy:a-(b<f?1:0),cm:f,cd:h,CM:(j?"\u95f0":"")+((f>9?"\u5341":"")+c.lunar.c1[f%10]).replace("\u5341\u4e8c","\u814a").replace(/^ä¸€/,"\u6b63")+"\u6708",CD:{10:"\u521d\u5341",20:"\u4e8c\u5341",30:"\u4e09\u5341"}[h]||c.lunar.c2[Math.floor(h/10)]+c.lunar.c1[h%10],isleap:j}},toGz:function(a,b,c){var e=d.getDateBySolar,f=d.cyclical;b=b-1;return{gy:b>=2||b==1&&c>=e(a,2).d?f(a-1864):f(a-1865),gm:c>=e(a,b*2).d?f((a-1900)*12+b+13):f((a-1900)*12+b+12),gd:f(Date.UTC(a,b,1,0,0,0,0)/864e5+25576+c)}},toSx:function(a,b,e){return c.lunar.sx.charAt((d.toLunar(a,b,e).cy-4)%12)},formatLunar:function(a,b,e){var f=d.toGz(a,b,e),g=d.toLunar(a,b,e),h=(new Date(a,b-1,e)).getDay();return{y:a,m:b,d:e,w:h,W:c.lunar.wk.charAt(h),cm:g.cm,cd:g.cd,CM:g.CM,CD:g.CD,gy:f.gy+"\u5e74",gm:f.gm+"\u6708",gd:f.gd+"\u65e5",so:d.getSolar(a,b,e),cf:d.getFeast(g.cm,g.cd,1,g.cy),gf:d.getFeast(b,e),sx:c.lunar.sx.charAt((g.cy-4)%12),isleap:g.isleap}},lunarTpl:function(a,b,e,f){if(arguments.length<4&&typeof e!="number"){var g=d.isDate(a),h=g?d.getDate(a):d.getDate();g&&(f=b),typeof a=="string"&&(f=a),a=h.y,b=h.m,e=h.d}return(f||c.lunar.tpl).replaceTpl(d.formatLunar(a,b,e))},toIsl:function(a,b,c){var d=a,e=b,f=c;e<3&&(d-=1,e+=12);var g=Math.floor(d/100),h=2-g+Math.floor(g/4),i,j,k,l,m;d<1583&&(h=0),d==1582&&(e>10&&(h=-10),e==10&&(h=0,f>4&&(h=-10))),i=Math.floor(365.25*(d+4716))+Math.floor(30.6001*(e+1))+f+h-1524,h=0,i>2299160&&(g=Math.floor((i-1867216.25)/36524.25),h=1+g-Math.floor(g/4)),j=i+h+1524,k=Math.floor((j-122.1)/365.25),l=Math.floor(365.25*k),m=Math.floor((j-l)/30.6001),f=j-l-Math.floor(30.6001*m),e=m-1,m>13&&(k+=1,e=m-13),d=k-4716;var n=((i+1)%7+7)%7+1,o=10631/30,p=1948084,q=1948085,r=.1335,s=i-p,t=Math.floor(s/10631),u,v,w,x;s=s-10631*t,u=Math.floor((s-r)/o),v=30*t+u,s=s-Math.floor(u*o+r),w=Math.floor((s+28.5001)/29.5),w==13&&(w=12),x=s-Math.floor(29.5001*w-29);return{iy:v,im:w,id:x,iw:n,jd:i-1}},formatIsl:function(a,b,e){var f=d.toIsl(a,b,e),g=c.isl,h=f.iw,i=f.im;return{y:a,m:b,d:e,iy:f.iy,im:i,id:f.id,iw:h,jd:f.jd,M:g.gMonthNames[b-1],IW:g.weekNames[h-1],MW:g.weekNames_Malay[h-1],IM:g.monthNames[i-1],MM:g.monthNames_Malay[i-1]}},islTpl:function(a,b,e,f){if(arguments.length<4&&typeof e!="number"){var g=d.isDate(a),h=g?d.getDate(a):d.getDate();g&&(f=b),typeof a=="string"&&(f=a),a=h.y,b=h.m,e=h.d}return(f||c.isl.tpl).replaceTpl(d.formatIsl(a,b,e))},debug:function(a,b){var c=0,d=G.date.getDaysByMonth(a,b);for(;c<d;c++)console.log(G.date.lunarTpl(a,b,c+1))}};G.date=d})(window)